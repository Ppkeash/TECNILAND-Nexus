<div id="overlayContainer" style="display: none;">
    <div id="serverSelectContent" style="display: none;">
        <span id="serverSelectHeader"><%- lang('overlay.serverSelectHeader') %></span>
        
        <!-- Tabs: Instalaciones Personalizadas | Servidores TECNILAND -->
        <div id="serverSelectTabs" class="instance-selector__tabs">
            <button id="tabInstallations" class="serverSelectTab instance-selector__tab instance-selector__tab--active" type="button">
                <img src="assets/images/icons/loaders/gamepad.svg" class="instance-selector__tab-icon" alt="">
                <span>INSTALACIONES PERSONALIZADAS</span>
            </button>
            <button id="tabServers" class="serverSelectTab instance-selector__tab instance-selector__tab--tecniland" type="button">
                <img src="assets/images/icons/loaders/server.svg" class="instance-selector__tab-icon" alt="">
                <span>TECNILAND</span>
            </button>
        </div>

        <!-- Hero Header para secci√≥n TECNILAND (oculto por defecto) -->
        <div id="tecnilandHeroHeader" class="tecniland-hero" style="display: none;">
            <div class="tecniland-hero__glow"></div>
            <div class="tecniland-hero__content">
                <img src="assets/images/icons/loaders/server.svg" class="tecniland-hero__logo" alt="TECNILAND">
                <div class="tecniland-hero__text">
                    <h2 class="tecniland-hero__title">SERVIDORES TECNILAND</h2>
                    <p class="tecniland-hero__subtitle">Modpacks oficiales optimizados y listos para jugar</p>
                </div>
            </div>
            <div class="tecniland-hero__stats">
                <div class="tecniland-hero__stat">
                    <span class="tecniland-hero__stat-value" id="heroModpackCount">0</span>
                    <span class="tecniland-hero__stat-label">Modpacks</span>
                </div>
                <div class="tecniland-hero__stat">
                    <span class="tecniland-hero__stat-value" id="heroInstalledCount">0</span>
                    <span class="tecniland-hero__stat-label">Instalados</span>
                </div>
            </div>
        </div>

        <div id="serverSelectList">
            <!-- Lista de instalaciones personalizadas -->
            <div id="installationSelectListScrollable" class="scrollbar-hidden" style="display: block;">
                <!-- Installation listings populated here. -->
            </div>
            <!-- Lista de Servidores/Modpacks TECNILAND -->
            <div id="serverSelectListScrollable" class="scrollbar-hidden tecniland-modpacks" style="display: none;">
                <!-- Populated dynamically by populateServerListings() -->
            </div>
        </div>

        <!-- Bot√≥n para crear nueva instalaci√≥n -->
        <div id="installationCreateButton" class="instance-selector__create-wrapper">
            <button id="createNewInstallation" class="instance-selector__create-btn">
                <img src="assets/images/icons/loaders/add.svg" class="instance-selector__create-icon" alt="">
                Nueva Instalaci√≥n
            </button>
        </div>

        <div id="serverSelectActions">
            <button id="serverSelectConfirm" class="overlayKeybindEnter" type="submit"><%- lang('overlay.serverSelectConfirm') %></button>
            <div id="serverSelectCancelWrapper">
                <button id="serverSelectCancel" class="overlayKeybindEsc"><%- lang('overlay.serverSelectCancel') %></button>
            </div>
        </div>
    </div>

    <!-- Installation Editor Panel (inline) -->
    <div id="installationEditorContent" class="scrollbar-hidden instance-editor" style="display: none;">
        <span id="installationEditorHeader" class="instance-editor__header">
            <img src="assets/images/icons/loaders/add.svg" class="instance-editor__header-icon" alt="">
            Nueva Instalaci√≥n
        </span>
        <p class="instance-editor__subtitle">Crea una instalaci√≥n personalizada con tu mod loader favorito</p>

        <div id="installationEditorErrorMessage" style="display: none; background: rgba(244, 67, 54, 0.9); color: white; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; font-size: 14px;"></div>


        <form id="installationEditorForm">
            <!-- Nombre -->
            <div class="installationEditorFormGroup">
                <label for="installationEditorName">Nombre de la instalaci√≥n</label>
                <input type="text" id="installationEditorName" placeholder="Mi Instalaci√≥n Personalizada" autocomplete="off" required>
            </div>

            <!-- Mod Loader -->
            <div class="installationEditorFormGroup">
                <label>Mod Loader</label>
                <div id="installationEditorLoaderSelector" class="instance-editor__loader-grid">
                    <button type="button" class="installationEditorLoaderBtn instance-editor__loader-btn active" data-loader="vanilla">
                        <img src="assets/images/icons/loaders/vanilla.svg" class="instance-editor__loader-icon" alt="">
                        <span>Vanilla</span>
                    </button>
                    <button type="button" class="installationEditorLoaderBtn instance-editor__loader-btn" data-loader="forge">
                        <img src="assets/images/icons/loaders/forge.svg" class="instance-editor__loader-icon" alt="">
                        <span>Forge</span>
                    </button>
                    <button type="button" class="installationEditorLoaderBtn instance-editor__loader-btn" data-loader="fabric">
                        <img src="assets/images/icons/loaders/fabric.svg" class="instance-editor__loader-icon" alt="">
                        <span>Fabric</span>
                    </button>
                    <button type="button" class="installationEditorLoaderBtn instance-editor__loader-btn" data-loader="quilt">
                        <img src="assets/images/icons/loaders/quilt.svg" class="instance-editor__loader-icon" alt="">
                        <span>Quilt</span>
                    </button>
                    <button type="button" class="installationEditorLoaderBtn instance-editor__loader-btn" data-loader="neoforge">
                        <img src="assets/images/icons/loaders/neoforge.svg" class="instance-editor__loader-icon" alt="">
                        <span>NeoForge</span>
                    </button>
                </div>
            </div>

            <!-- Versi√≥n de Minecraft -->
            <div class="installationEditorFormGroup">
                <label for="installationEditorMcVersion">Versi√≥n de Minecraft</label>
                <select id="installationEditorMcVersion" required>
                    <option value="">Cargando versiones...</option>
                </select>
                <small id="installationEditorMcVersionInfo" style="display: none; color: rgba(255, 255, 255, 0.6); font-size: 11px; margin-top: 4px; display: block;"></small>
            </div>

            <!-- Versi√≥n del Loader -->
            <div class="installationEditorFormGroup" id="installationEditorLoaderVersionGroup" style="display: none;">
                <label for="installationEditorLoaderVersion">Versi√≥n del Loader</label>
                <select id="installationEditorLoaderVersion">
                    <option value="">Selecciona primero una versi√≥n de Minecraft</option>
                </select>
            </div>

            <!-- Botones de acci√≥n -->
            <div id="installationEditorActions" class="instance-editor__actions">
                <button type="button" id="installationEditorCancel" class="instance-editor__btn instance-editor__btn--cancel">
                    Cancelar
                </button>
                <button type="submit" id="installationEditorCreate" class="instance-editor__btn instance-editor__btn--submit" disabled>
                    Crear Instalaci√≥n
                </button>
            </div>
        </form>
    </div>

    <div id="accountSelectContent" style="display: none;">
        <span id="accountSelectHeader"><%- lang('overlay.accountSelectHeader') %></span>
        <div id="accountSelectList">
            <div id="accountSelectListScrollable" class="scrollbar-hidden">
                <!-- Accounts populated here. -->
            </div>
        </div>
        <div id="accountSelectActions">
            <button id="accountSelectConfirm" class="overlayKeybindEnter" type="submit"><%- lang('overlay.accountSelectConfirm') %></button>
            <div id="accountSelectCancelWrapper">
                <button id="accountSelectCancel" class="overlayKeybindEsc"><%- lang('overlay.accountSelectCancel') %></button>
            </div>
        </div>
    </div>
    <div id="overlayContent">
        <span id="overlayTitle">Lorem Ipsum:<br>Finis Illud</span>
        <span id="overlayDesc">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud..</span>
        <div id="overlayActionContainer">
            <button id="overlayAcknowledge" class="overlayKeybindEnter">Conare Iterum</button>
            <div id="overlayDismissWrapper">
                <button id="overlayDismiss" style="display: none;" class="overlayKeybindEsc">Dismiss</button>
            </div>
        </div>
    </div>

    <!-- ==================== SKIN EDITOR OVERLAY ==================== -->
    <!-- 
        Editor de Skin para cuentas offline de TECNILAND Nexus.
        Preview 2.5D con canvas (Option B futura: skinview3d para 3D completo).
        Estructura de carpetas:
        - tecniland/skins/accounts/<uuid>.png (skin activa)
        - tecniland/skins/gallery/*.png (galer√≠a compartida)
    -->
    <div id="skinEditorContent" style="display: none;">
        <div class="skinEditorHeader">
            <span id="skinEditorTitle"><%- lang('settings.skinEditor.title') %></span>
            <span id="skinEditorUsername" class="skinEditorSubtitle"></span>
        </div>

        <!-- Advertencia sobre limitaci√≥n t√©cnica de skins in-game -->
        <div class="skinEditorWarning">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <div class="skinEditorWarningText">
                <strong><%- lang('settings.skinEditor.warning.title') %></strong>
                <p><%- lang('settings.skinEditor.warning.message') %></p>
            </div>
        </div>

        <div class="skinEditorMain">
            <!-- Preview del personaje -->
            <div class="skinEditorPreviewSection">
                <div class="skinEditorPreviewContainer">
                    <canvas id="skinEditorCanvas" width="128" height="160"></canvas>
                    <div id="skinEditorNoSkin" class="skinEditorPlaceholder">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        <span><%- lang('settings.skinEditor.noSkin') %></span>
                    </div>
                </div>
                
                <!-- Selector de modelo -->
                <div class="skinEditorModelSelector">
                    <span class="skinEditorModelLabel"><%- lang('settings.skinEditor.model') %></span>
                    <div class="skinEditorModelButtons">
                        <button class="skinEditorModelBtn active" data-model="classic">
                            <span class="skinEditorModelIcon">üë§</span>
                            <span><%- lang('settings.skinEditor.modelClassic') %></span>
                        </button>
                        <button class="skinEditorModelBtn" data-model="slim">
                            <span class="skinEditorModelIcon">üë§</span>
                            <span><%- lang('settings.skinEditor.modelSlim') %></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Acciones y galer√≠a -->
            <div class="skinEditorActionsSection">
                <button id="skinEditorChangeSkin" class="skinEditorBtn skinEditorBtnPrimary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <span><%- lang('settings.skinEditor.changeSkin') %></span>
                </button>

                <button id="skinEditorRemoveSkin" class="skinEditorBtn skinEditorBtnDanger" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                    <span><%- lang('settings.skinEditor.removeSkin') %></span>
                </button>

                <!-- Galer√≠a de skins -->
                <div class="skinEditorGallerySection">
                    <span class="skinEditorGalleryTitle"><%- lang('settings.skinEditor.gallery') %></span>
                    <div id="skinEditorGalleryGrid" class="skinEditorGalleryGrid">
                        <!-- Miniaturas de la galer√≠a se cargan din√°micamente -->
                        <div class="skinEditorGalleryEmpty">
                            <span><%- lang('settings.skinEditor.galleryEmpty') %></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mensaje de estado (cambios pendientes) -->
        <div id="skinEditorPendingChanges" class="skinEditorPendingChanges" style="display: none;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <span><%- lang('settings.skinEditor.pendingChanges') %></span>
        </div>

        <!-- Botones de acci√≥n -->
        <div id="skinEditorActions" class="skinEditorFooterActions">
            <button id="skinEditorSave" class="skinEditorBtn skinEditorBtnSuccess" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span><%- lang('settings.skinEditor.save') %></span>
            </button>
            <button id="skinEditorDiscard" class="skinEditorBtn skinEditorBtnSecondary" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
                <span><%- lang('settings.skinEditor.discard') %></span>
            </button>
            <button id="skinEditorClose" class="skinEditorBtn skinEditorBtnSecondary">
                <span><%- lang('settings.skinEditor.close') %></span>
            </button>
        </div>
    </div>
    <!-- ==================== FIN SKIN EDITOR OVERLAY ==================== -->

    <script src="./assets/js/scripts/overlay.js"></script>
</div>

<!-- Men√∫ contextual personalizado para instalaciones -->
<div id="installationContextMenu" class="contextMenu" style="display: none;">
    <div class="contextMenuItem" id="contextMenuEdit">
        <span class="contextMenuIcon">‚úèÔ∏è</span>
        <span class="contextMenuLabel">Editar instalaci√≥n</span>
    </div>
    <div class="contextMenuDivider"></div>
    <div class="contextMenuItem contextMenuDanger" id="contextMenuDelete">
        <span class="contextMenuIcon">üóëÔ∏è</span>
        <span class="contextMenuLabel">Eliminar instalaci√≥n</span>
    </div>
</div>